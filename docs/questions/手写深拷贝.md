# 手写深拷贝

## 浅拷贝

- 浅拷贝是值的赋值,对于对象是内存地址的赋值,目标对象的引用和原对象的引用指向的是同一块内存空间.如果其中一个对象改变,就会影响到另一个对象

```js
// Array.prototype.slice

let arr1 = [{ a: 1, b: 2 }, { c: 1 }];
let newArr = arr1.slice();
// 扩展运算符
let newArr = [...arr1];
```

## 深拷贝

- 深拷贝是将一个对象从内存中完整的拷贝一份出来,对象与对象间不会共享内存,而是在堆内存中心开辟一个空间去储存,所以修改心对象不会影响原对象
- 常用方法:

```js
// 方法一:
JSON.parse(JSON.stringify(arr));
// 作用于对象深拷贝
Object.assign({}, sourceTarget);
```

- 手写深拷贝

```js
function deepClone(obj, map = new WeakMap()) {
  if (obj === null || typeof obj !== 'object') return obj;
  const type = Object.prototype.toSting().call(obj).slice(8, -1);
  let strategy = {
    Date: (obj) => new Date(obj),
    RegExp: (obj) => new RegExp(obj),
    Array: clone,
    Object: clone,
  };

  function clone(obj) {
    if (map.get(obj)) return map.get(obj);
    let target = new obj.constructor();
    map.set(obj, target);
    for (let key in obj) {
      if (obj.hasOwnProperty(key)) {
        target[key] = deepClone(obj[key], map);
      }
    }
    return target;
  }
  return strategy[type] && strategy[type](obj);
}
```
